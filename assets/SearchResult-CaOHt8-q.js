import{e as X,u as Z,f as j,g as ee,P as se,t as te,h as ae,i as L,j as E,k as t,l as le,w as I,m as re,R as b,n as ue,p as ie,q as oe,s as ne,v as ce,x as B,y as F,C as ve,z as he,A as pe,B as de,D as ye,E as me,F as ge,G as _,H as fe,I as Q}from"./app-Bkp631OD.js";const He=["/","/intro.html","/Basic/LeetCode/","/Others/ElectronicProduct/","/Others/ElectronicProduct/computer.html","/Others/ElectronicProduct/keyboard.html","/Others/ElectronicProduct/mouse.html","/Others/ElectronicProduct/screen.html","/Tools/Resource/","/404.html","/Basic/","/Others/","/Tools/","/category/","/tag/","/tag/%E8%B5%84%E6%BA%90%E6%95%B4%E5%90%88/","/article/","/star/","/timeline/"],Re="SEARCH_PRO_QUERY_HISTORY",m=_(Re,[]),ke=()=>{const{queryHistoryCount:l}=Q;return{enabled:l>0,queryHistory:m,addQueryHistory:i=>{m.value=Array.from(new Set([i,...m.value.slice(0,l-1)]))},removeQueryHistory:i=>{m.value=[...m.value.slice(0,i),...m.value.slice(i+1)]}}},O=l=>He[l.id]+("anchor"in l?`#${l.anchor}`:""),we="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:$}=Q,g=_(we,[]),Ee=()=>({enabled:$>0,resultHistory:g,addResultHistory:r=>{{const i={link:O(r),display:r.display};"header"in r&&(i.header=r.header),g.value=[i,...g.value.slice(0,$-1)]}},removeResultHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}),Qe=l=>{const r=ve(),i=j(),q=he(),o=L(0),f=E(()=>o.value>0),h=pe([]);return de(()=>{const{search:x,terminate:p}=ye(),H=me(y=>{const R=y.join(" "),{searchFilter:d=a=>a,splitWord:D,suggestionsFilter:u,...n}=r.value;R?(o.value+=1,x(y.join(" "),i.value,n).then(a=>d(a,R,i.value,q.value)).then(a=>{o.value-=1,h.value=a}).catch(a=>{console.warn(a),o.value-=1,o.value||(h.value=[])})):h.value=[]},Q.searchDelay-Q.suggestDelay);I([l,i],([y])=>H(y),{immediate:!0}),ge(()=>{p()})}),{isSearching:f,results:h}};var xe=X({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:r}){const i=Z(),q=j(),o=ee(se),{addQueryHistory:f,queryHistory:h,removeQueryHistory:x}=ke(),{resultHistory:p,addResultHistory:H,removeResultHistory:y}=Ee(),R=te(l,"queries"),{results:d,isSearching:D}=Qe(R),u=ae({isQuery:!0,index:0}),n=L(0),a=L(0),A=E(()=>h.value.length>0||p.value.length>0),C=E(()=>d.value.length>0),P=E(()=>d.value[n.value]||null),U=()=>{const{isQuery:e,index:s}=u;s===0?(u.isQuery=!e,u.index=e?p.value.length-1:h.value.length-1):u.index=s-1},Y=()=>{const{isQuery:e,index:s}=u;s===(e?h.value.length-1:p.value.length-1)?(u.isQuery=!e,u.index=0):u.index=s+1},M=()=>{n.value=n.value>0?n.value-1:d.value.length-1,a.value=P.value.contents.length-1},z=()=>{n.value=n.value<d.value.length-1?n.value+1:0,a.value=0},G=()=>{a.value<P.value.contents.length-1?a.value+=1:z()},V=()=>{a.value>0?a.value-=1:M()},S=e=>e.map(s=>fe(s)?s:t(s[0],s[1])),J=e=>{if(e.type==="customField"){const s=ne[e.index]||"$content",[c,w=""]=ce(s)?s[q.value].split("$content"):s.split("$content");return e.display.map(v=>t("div",S([c,...v,w])))}return e.display.map(s=>t("div",S(s)))},k=()=>{n.value=0,a.value=0,r("updateQuery",""),r("close")},K=()=>t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.queryHistory),h.value.map((e,s)=>t("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===s}],onClick:()=>{r("updateQuery",e)}},[t(B,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:c=>{c.preventDefault(),c.stopPropagation(),x(s)}})]))])),N=()=>t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.resultHistory),p.value.map((e,s)=>t(b,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===s}],onClick:()=>{k()}},()=>[t(B,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>S(c)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:c=>{c.preventDefault(),c.stopPropagation(),y(s)}})]))]));return le("keydown",e=>{if(l.isFocusing){if(C.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const s=P.value.contents[a.value];f(l.queries.join(" ")),H(s),i.push(O(s)),k()}}else if(e.key==="ArrowUp")U();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:s}=u;u.isQuery?(r("updateQuery",h.value[s]),e.preventDefault()):(i.push(p.value[s].link),k())}}}),I([n,a],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!C.value:!A.value}],id:"search-pro-results"},l.queries.length?D.value?t(re,{hint:o.value.searching}):C.value?t("ul",{class:"search-pro-result-list"},d.value.map(({title:e,contents:s},c)=>{const w=n.value===c;return t("li",{class:["search-pro-result-list-item",{active:w}]},[t("div",{class:"search-pro-result-title"},e||o.value.defaultTitle),s.map((v,W)=>{const T=w&&a.value===W;return t(b,{to:O(v),class:["search-pro-result-item",{active:T,"aria-selected":T}],onClick:()=>{f(l.queries.join(" ")),H(v),k()}},()=>[v.type==="text"?null:t(v.type==="title"?ue:v.type==="heading"?ie:oe,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[v.type==="text"&&v.header?t("div",{class:"content-header"},v.header):null,t("div",J(v))])])})])})):o.value.emptyResult:A.value?[K(),N()]:o.value.emptyHistory)}});export{xe as default};
